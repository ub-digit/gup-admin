{"version":3,"file":"_id_-f2d203ec.js","sources":["../../../../components/PostRowGup.vue","../../../../pages/publications/post/[id].vue"],"sourcesContent":["<template>\n    <div>\n        <NuxtLink :to=\"{name:'publications-post-id-gup-gupid', query: $route.query, params: {gupid: post.gup_id}}\" class=\"list-group-item list-group-item-action\">\n            <div class=\"d-flex w-100 justify-content-between\">\n                <h5 class=\"title mb-1\">{{ post.title }}</h5>\n                <small class=\"text-muted\">GUP-ID: {{ post.gup_id }}</small>\n            </div>\n            <p class=\"mb-0\">{{post.date}}</p>\n            <small>{{post.pubtype}}<br>\n            {{ post.number_of_authors }} författare</small>\n        </NuxtLink>\n    </div>\n</template>\n\n<script setup>\nconst props = defineProps(['post', 'refresh'])\nconst {t} = useI18n();\n\n\n</script>\n\n<style lang=\"scss\" scoped>\n.list-group-item  {\n    &.router-link-active {\n      background: rgb(223, 222, 222);\n    }\n}\n</style>","<template>\n      <div class=\"col-6\">\n         <ErrorLoadingPost v-if=\"errorImportedPostById\" :error=\"errorImportedPostById\"/> \n        <div v-else>\n          <div class=\"row\">\n            <div class=\"col\" :class=\"{'opacity-50' :pendingImportedPostById}\">\n              <h2 class=\"pb-0 mb-4\">{{ importedPostById.title }}</h2>\n            </div>\n            <div class=\"col-auto\">\n              <Spinner v-if=\"pendingGupPostsByTitle || pendingGupPostsById || pendingImportedPostById\" class=\"me-4\"/>            \n              </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col\">\n              <PostDisplay :class=\"{'opacity-50' :pendingImportedPostById}\" :post=\"importedPostById\" />\n            </div>\n          </div>\n          <div class=\"row pb-4\">\n            <div class=\"col text-end\">\n              <button type=\"button\" class=\"btn btn-danger me-1\" @click=\"removePost\">{{t('buttons.remove')}}</button>\n              <button type=\"button\" class=\"btn btn-secondary me-1\" @click=\"editPost\">{{t('buttons.edit')}}</button>\n              <button type=\"button\" class=\"btn btn-success\" @click=\"mergePosts\">{{t('buttons.merge')}}</button>\n            </div>\n          </div>\n\n          <h3 class=\"mb-4\">{{ t('views.publications.post.result_list.header') }}</h3>\n\n          <div class=\"row pb-4\">\n            <div class=\"col\">\n              <h4 class=\"mb-1 text-muted\">{{ t('views.publications.post.result_list_by_id.header') }}</h4>\n              <div v-if=\"!gupPostsById.length\">{{ t('views.publications.post.result_list.no_gup_posts_by_id_found') }}</div>\n              <div v-else :class=\"{'opacity-50' :pendingGupPostsById}\" class=\"list-group list-group-flush border-bottom\">\n                <PostRowGup v-for=\"post in gupPostsById\" :post=\"post\" :refresh=\"$route.query\" :key=\"post.id\"/>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"row\">\n            <div class=\"col\">\n              <div class=\"row\">\n                <div class=\"col\">\n                  <h4 class=\"mb-1 text-muted\">{{ t('views.publications.post.result_list_by_title.header') }}</h4>\n                </div>\n                <div class=\"col-auto\">\n                  <Spinner v-if=\"pendingGupPostsByTitle\" class=\"me-4\"/>            \n                </div>\n              </div>\n              <div class=\"row\">\n                <div class=\"col\">\n                  <label class=\"d-none\" for=\"title-search\">Sök på titel</label>\n                  <input id=\"title-search\" class=\"form-control mb-3\" type=\"search\" v-model=\"searchTitleStr\">\n                  <div v-if=\"!gupPostsByTitle.length\">{{ t('views.publications.post.result_list.no_gup_posts_by_title_found') }}</div>\n                  <div v-else :class=\"{'opacity-50': pendingGupPostsByTitle}\" class=\"list-group list-group-flush border-bottom\">\n                    <PostRowGup v-for=\"post in gupPostsByTitle\" :post=\"post\" :key=\"post.id\"/>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n        </div>\n      </div>\n      <div class=\"col-6\">\n        <NuxtPage/>\n      </div>\n</template>\n\n<script setup>\nimport { useDebounceFn } from '@vueuse/core'\nimport { useGupPostsStore } from '~/store/gup_posts'\nimport { useImportedPostsStore } from '~/store/imported_posts'\nimport { useFilterStore } from '~~/store/filter'\nimport { storeToRefs } from 'pinia'\nconst {t} = useI18n();\nconst route = useRoute();\nconst router = useRouter();\nconst searchTitleStr = ref(null);\nconst { $toast } = useNuxtApp();\n\n  const filterStore = useFilterStore();\n\n  const importedPostsStore = useImportedPostsStore();\n  const {fetchImportedPostById, removeImportedPost, fetchImportedPosts} = importedPostsStore;\n  const {importedPostById, pendingImportedPostById, errorImportedPostById} = storeToRefs(importedPostsStore) \n\n  const gupPostsStore = useGupPostsStore()\n  const { fetchGupPostsByTitle, fetchGupPostsById } = gupPostsStore\n  const { gupPostsByTitle, pendingGupPostsByTitle, gupPostsById, pendingGupPostsById, gupPostById, pendingGupPostById } = storeToRefs(gupPostsStore)\n\n  await fetchImportedPostById(route.params.id);\n  searchTitleStr.value = importedPostById.value ? importedPostById.value.title : \"\";\n  \n  if (importedPostById.value) {\n    await fetchGupPostsById(importedPostById.value.id);\n    await fetchGupPostsByTitle(importedPostById.value.id, importedPostById.value.title);\n  }\n  \n  \n  const debounceFn = useDebounceFn(() => {\n    if (importedPostById ) {\n      fetchGupPostsByTitle({title: searchTitleStr.value});\n    }\n  }, 500)\n \n  watch(\n    searchTitleStr,\n  () => {\n    debounceFn();\n  }\n)\n\nfunction mergePosts() {\n  alert(\"merge\")\n}\nasync function removePost() {\n  const ok = confirm(t('messages.confirm_remove'))\n  if (ok) {\n    const res = await removeImportedPost(importedPostById.value.id);\n    fetchImportedPosts();\n   \n    //$toast.success('Yay!!!')\n    $toast.success(t('messages.remove_success'));\n    router.push({ path: '/publications', query: { ...route.query } })\n  }\n}\nfunction editPost() {\n  alert(\"Edit in GUP\")\n}\n</script>\n\n<style lang=\"scss\" scoped>\n\n</style>"],"names":["_withAsyncContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBA,YAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACyDA,UAAA,EAAA,EAAA,IAAA;AACA,UAAA,QAAA,SAAA;AACA,cAAA;AACA,UAAA,iBAAA,IAAA,IAAA;AACA,eAAA;AAEA,mBAAA;AAEA,UAAA,qBAAA;AACA,UAAA,EAAA,uBAAA,oBAAA,mBAAA,IAAA;AACA,UAAA,EAAA,kBAAA,yBAAA,sBAAA,IAAA,YAAA,kBAAA;AAEA,UAAA,gBAAA,iBAAA;AACA,UAAA,EAAA,sBAAA,kBAAA,IAAA;AACA,UAAA,EAAA,iBAAA,wBAAA,cAAA,qBAAA,aAAA,mBAAA,IAAA,YAAA,aAAA;AAEA,IAAQ,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAA,sBAAA,MAAA,OAAA,EAAA,CAAA;AACR,mBAAA,QAAA,iBAAA,QAAA,iBAAA,MAAA,QAAA;AAEA,QAAA,iBAAA,OAAA;AACA,MAAU,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAA,kBAAA,iBAAA,MAAA,EAAA,CAAA;AACV,MAAU,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAA,qBAAA,iBAAA,MAAA,IAAA,iBAAA,MAAA,KAAA,CAAA;IACV;AAGA,UAAA,aAAA,cAAA,MAAA;AACA,UAAA,kBAAA;AACA,6BAAA,EAAA,OAAA,eAAA,MAAA,CAAA;AAAA,MACA;AAAA,IACA,GAAA,GAAA;AAEA;AAAA,MACA;AAAA,MACA,MAAA;AACA;MACA;AAAA,IACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}